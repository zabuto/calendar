/*! Zabuto Calendar - v1.3 - 2015-05-05
* https://github.com/zabuto/calendar
* Copyright (c) 2015 Anke Heijnen; Licensed MIT */
if("undefined"==typeof jQuery)throw new Error("jQuery is not loaded");$.fn.zabuto_calendar=function(a){var b=$.extend({},$.fn.zabuto_calendar_defaults(),a),c=$.fn.zabuto_calendar_language(b.language);return b=$.extend({},b,c),this.each(function(){function a(){var a=parseInt(t.data("initYear")),b=parseInt(t.data("initMonth"))-1,e=new Date(a,b,1,0,0,0,0);t.data("initDate",e);var f,g,h=t.data("cellBorder")===!0?" table-bordered":"";f=$('<table class="table'+h+'"></table>'),f=c(t,f,e.getFullYear(),e.getMonth()),g=d(t);var j=$('<div class="zabuto_calendar" id="'+t.attr("id")+'"></div>');j.append(f),j.append(g),t.append(j);var k=t.data("jsonData");!1!==k&&i(t,e.getFullYear(),e.getMonth())}function c(a,b,c,d){var h=new Date(c,d,1,0,0,0,0);return a.data("currDate",h),b.empty(),b=e(a,b,c,d),b=f(a,b),b=g(a,b,c,d),i(a,c,d),b}function d(a){var b,c,d=$('<div class="legend" id="'+a.attr("id")+'_legend"></div>'),e=a.data("legendList");return"object"==typeof e&&e.length>0&&$(e).each(function(a,e){if("object"==typeof e&&"type"in e){var f="";switch("label"in e&&(f=e.label),e.type){case"text":if(""!==f){var g="";"badge"in e&&(b="undefined"==typeof e.classname?"badge-event":e.classname,g='<span class="badge '+b+'">'+e.badge+"</span> "),d.append('<span class="legend-'+e.type+'">'+g+f+"</span>")}break;case"block":""!==f&&(f="<span>"+f+"</span>"),c="undefined"==typeof e.classname?"event":"event-styled "+e.classname,d.append('<span class="legend-'+e.type+'"><ul class="legend"><li class="'+c+'"></li></u>'+f+"</span>");break;case"list":if("list"in e&&"object"==typeof e.list&&e.list.length>0){var h=$('<ul class="legend"></u>');$(e.list).each(function(a,b){h.append('<li class="'+b+'"></li>')}),d.append(h)}break;case"spacer":d.append('<span class="legend-'+e.type+'"> </span>')}}}),d}function e(a,b,d,e){var f,g,h,i,j=a.data("navIcons"),k=$('<span><span class="glyphicon glyphicon-chevron-left"></span></span>'),l=$('<span><span class="glyphicon glyphicon-chevron-right"></span></span>');"object"==typeof j&&("prev"in j&&k.html(j.prev),"next"in j&&l.html(j.next));var m=a.data("showPrevious");("number"==typeof m||m===!1)&&(m=s(a.data("showPrevious"),!0));var n=$('<div class="calendar-month-navigation"></div>');n.attr("id",a.attr("id")+"_nav-prev"),n.data("navigation","prev"),m!==!1&&(f=e-1,g=d,-1===f&&(g-=1,f=11),n.data("to",{year:g,month:f+1}),n.append(k),"function"==typeof a.data("actionNavFunction")&&n.click(a.data("actionNavFunction")),n.click(function(d){d.preventDefault(),c(a,b,g,f)}));var o=a.data("showNext");("number"==typeof o||o===!1)&&(o=s(a.data("showNext"),!1));var p=$('<div class="calendar-month-navigation"></div>');p.attr("id",a.attr("id")+"_nav-next"),p.data("navigation","next"),o!==!1&&(h=e+1,i=d,12===h&&(i+=1,h=0),p.data("to",{year:i,month:h+1}),p.append(l),"function"==typeof a.data("actionNavFunction")&&p.click(a.data("actionNavFunction")),p.click(function(d){d.preventDefault(),c(a,b,i,h)}));var q=a.data("monthLabels"),r=$("<th></th>").append(n),t=$("<th></th>").append(p),u=$("<span>"+q[e]+" "+d+"</span>");u.dblclick(function(){var d=a.data("initDate");c(a,b,d.getFullYear(),d.getMonth())});var v=$('<th colspan="5"></th>');v.append(u);var w=$('<tr class="calendar-month-header"></tr>');return w.append(r,v,t),b.append(w),b}function f(a,b){if(a.data("showDays")===!0){var c=a.data("weekStartsOn"),d=a.data("dowLabels");if(0===c){var e=$.extend([],d),f=new Array(e.pop());d=f.concat(e)}var g=$('<tr class="calendar-dow-header"></tr>');$(d).each(function(a,b){g.append("<th>"+b+"</th>")}),b.append(g)}return b}function g(a,b,c,d){var e=q(c,d),f=p(c,d),g=o(c,d,1),h=o(c,d,f),i=1,j=a.data("weekStartsOn");0===j&&(6===h&&e++,6!==g||0!==h&&1!==h&&5!==h||e--,g++,7===g&&(g=0));for(var k=function(){a.data("selectedDate",$(this).data("date"))},l=0;e>l;l++){for(var r=$('<tr class="calendar-dow"></tr>'),s=0;7>s;s++){if(g>s||i>f)r.append("<td></td>");else{var t=a.attr("id")+"_"+n(c,d,i),u=t+"_day",v=$('<div id="'+u+'" class="day" >'+i+"</div>");v.data("day",i),a.data("showToday")===!0&&m(c,d,i)&&v.html('<span class="badge badge-today">'+i+"</span>");var w=$('<td id="'+t+'"></td>');w.append(v),w.data("date",n(c,d,i)),w.data("hasEvent",!1),"function"==typeof a.data("actionFunction")&&(w.addClass("dow-clickable"),w.click(k.apply(w)),w.click(a.data("actionFunction"))),r.append(w),i++}6===s&&(g=0)}b.append(r)}return b}function h(a,b,c,d){var e=$('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'),f=$('<h4 class="modal-title" id="'+a+'_modal_title">'+b+"</h4>"),g=$('<div class="modal-header"></div>');g.append(e),g.append(f);var h=$('<div class="modal-body" id="'+a+'_modal_body">'+c+"</div>"),i=$('<div class="modal-footer" id="'+a+'_modal_footer"></div>');if("undefined"!=typeof d){var j=$("<div>"+d+"</div>");i.append(j)}var k=$('<div class="modal-content"></div>');k.append(g),k.append(h),k.append(i);var l=$('<div class="modal-dialog"></div>');l.append(k);var m=$('<div class="modal fade" id="'+a+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+a+'_modal_title" aria-hidden="true"></div>');return m.append(l),m.data("dateId",a),m.attr("dateId",a),m}function i(a,b,c){var d=a.data("jsonData"),e=a.data("ajaxSettings");return a.data("events",!1),!1!==d?j(a):!1!==e?k(a,b,c):!0}function j(a){var b=a.data("jsonData");return a.data("events",b),l(a,"json"),!0}function k(a,b,c){var d=a.data("ajaxSettings");if("object"!=typeof d||"undefined"==typeof d.url)throw new Error("Invalid calendar event settings");var e={year:b,month:c+1};return $.ajax({type:"GET",url:d.url,data:e,dataType:"json"}).done(function(b){var c=[];$.each(b,function(a){c.push(b[a])}),a.data("events",c),l(a,"ajax")}),!0}function l(a,b){var c=a.data("ajaxSettings"),d=a.data("events");d!==!1&&$(d).each(function(d,e){var f=a.attr("id")+"_"+e.date,g=$("#"+f),i=$("#"+f+"_day");g.data("hasEvent",!0),g.data("eventsCount",g.data("eventsCount")?g.data("eventsCount")+1:1);var j=g.data("events")||[];if(j.push(e),g.data("events",j),"undefined"!=typeof e.title&&g.attr("title",e.title),"undefined"==typeof e.classname?g.addClass("event"):(g.addClass("event-styled"),i.addClass(e.classname)),"undefined"!=typeof e.badge&&e.badge!==!1){var k=e.badge===!0?"":" badge-"+e.badge,l=i.data("day");i.html('<span class="badge badge-event'+k+'">'+l+"</span>")}if("undefined"!=typeof e.body){var m=!1;if("json"===b&&"undefined"!=typeof e.modal&&e.modal===!0?m=!0:"ajax"===b&&"modal"in c&&c.modal===!0&&(m=!0),m===!0){g.addClass("event-clickable");var n=h(f,e.title,e.body,e.footer);$("body").append(n),$("#"+f).click(function(){$("#"+f+"_modal").modal()})}}})}function m(a,b,c){var d=new Date,e=new Date(a,b,c);return e.toDateString()===d.toDateString()}function n(a,b,c){var d,e;return d=10>c?"0"+c:c,e=b+1,e=10>e?"0"+e:e,a+"-"+e+"-"+d}function o(a,b,c){var d=new Date(a,b,c,0,0,0,0),e=d.getDay();return 0===e?e=6:e--,e}function p(a,b){for(var c=28;r(a,b+1,c+1);)c++;return c}function q(a,b){var c=p(a,b),d=o(a,b,1),e=o(a,b,c),f=c,g=d-e;return g>0&&(f+=g),Math.ceil(f/7)}function r(a,b,c){return b>0&&13>b&&a>0&&32768>a&&c>0&&c<=new Date(a,b,0).getDate()}function s(a,b){a===!1&&(a=0);var c,d=t.data("currDate"),e=t.data("initDate");if(c=12*(e.getFullYear()-d.getFullYear()),c-=d.getMonth()+1,c+=e.getMonth(),b===!0){if(c<parseInt(a)-1)return!0}else if(c>=0-parseInt(a))return!0;return!1}var t=$(this);t.attr("id","zabuto_calendar_"+Math.floor(99999*Math.random()).toString(36)),t.data("initYear",b.year),t.data("initMonth",b.month),t.data("monthLabels",b.month_labels),t.data("weekStartsOn",b.weekstartson),t.data("navIcons",b.nav_icon),t.data("dowLabels",b.dow_labels),t.data("showToday",b.today),t.data("showDays",b.show_days),t.data("showPrevious",b.show_previous),t.data("showNext",b.show_next),t.data("cellBorder",b.cell_border),t.data("jsonData",b.data),t.data("ajaxSettings",b.ajax),t.data("legendList",b.legend),t.data("actionFunction",b.action),t.data("actionNavFunction",b.action_nav),a()}),this},$.fn.zabuto_calendar_defaults=function(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,d={language:!1,year:b,month:c,show_previous:!0,show_next:!0,cell_border:!1,today:!1,show_days:!0,weekstartson:1,nav_icon:!1,data:!1,ajax:!1,legend:!1,action:!1,action_nav:!1};return d},$.fn.zabuto_calendar_language=function(a){switch(("undefined"==typeof a||a===!1)&&(a="en"),a.toLowerCase()){case"de":return{month_labels:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dow_labels:["Mo","Di","Mi","Do","Fr","Sa","So"]};case"en":return{month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],dow_labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};case"ar":return{month_labels:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],dow_labels:["أثنين","ثلاثاء","اربعاء","خميس","جمعه","سبت","أحد"]};case"es":return{month_labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dow_labels:["Lu","Ma","Mi","Ju","Vi","Sá","Do"]};case"fr":return{month_labels:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dow_labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]};case"it":return{month_labels:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dow_labels:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"]};case"nl":return{month_labels:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],dow_labels:["Ma","Di","Wo","Do","Vr","Za","Zo"]};case"pt":return{month_labels:["Janeiro","Fevereiro","Marco","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dow_labels:["S","T","Q","Q","S","S","D"]};case"ru":return{month_labels:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dow_labels:["Пн","Вт","Ср","Чт","Пт","Сб","Вск"]};case"se":return{month_labels:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dow_labels:["Mån","Tis","Ons","Tor","Fre","Lör","Sön"]};case"tr":return{month_labels:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dow_labels:["Pts","Salı","Çar","Per","Cuma","Cts","Paz"]}}};