!function(a){if("undefined"==typeof a)throw new Error("jQuery is not loaded");var b=a;b.fn.zabuto_calendar=function(a){var c=b.extend({},b.fn.zabuto_calendar_defaults(),a),d=b.fn.zabuto_calendar_language(c.language);return c=b.extend({},c,d),this.each(function(){function d(){var c=parseInt(a.data("initYear")),d=parseInt(a.data("initMonth"))-1,g=new Date(c,d,1,0,0,0,0);a.data("initDate",g);var h=a.data("cellBorder")===!0?" table-bordered":"",i=b('<table class="table'+h+'"></table>');i=e(a,i,g.getFullYear(),g.getMonth());var j=f(a),l=b('<div class="zabuto_calendar" id="'+a.attr("id")+'"></div>');l.append(i),l.append(j),a.append(l);var m=a.data("jsonData");!1!==m&&k(a,g.getFullYear(),g.getMonth())}function e(a,b,c,d){var e=new Date(c,d,1,0,0,0,0);return a.data("currDate",e),b.empty(),b=g(a,b,c,d),b=h(a,b),b=i(a,b,c,d),k(a,c,d),b}function f(a){var c=b('<div class="legend" id="'+a.attr("id")+'_legend"></div>'),d=a.data("legendList");return"object"==typeof d&&d.length>0&&b(d).each(function(a,d){if("object"==typeof d&&"type"in d){var e="";switch("label"in d&&(e=d.label),d.type){case"text":if(""!==e){var f="";if("badge"in d){if("undefined"==typeof d.classname)var g="badge-event";else var g=d.classname;f='<span class="badge '+g+'">'+d.badge+"</span> "}c.append('<span class="legend-'+d.type+'">'+f+e+"</span>")}break;case"block":if(""!==e&&(e="<span>"+e+"</span>"),"undefined"==typeof d.classname)var h="event";else var h="event-styled "+d.classname;c.append('<span class="legend-'+d.type+'"><ul class="legend"><li class="'+h+'"></li></u>'+e+"</span>");break;case"list":if("list"in d&&"object"==typeof d.list&&d.list.length>0){var i=b('<ul class="legend"></u>');b(d.list).each(function(a,b){i.append('<li class="'+b+'"></li>')}),c.append(i)}break;case"spacer":c.append('<span class="legend-'+d.type+'"> </span>')}}}),c}function g(a,c,d,f){var g=a.data("navIcons"),h=b('<span><span class="glyphicon glyphicon-chevron-left"></span></span>'),i=b('<span><span class="glyphicon glyphicon-chevron-right"></span></span>');"object"==typeof g&&("prev"in g&&h.html(g.prev),"next"in g&&i.html(g.next));var j=a.data("showPrevious");"number"!=typeof j&&j!==!1||(j=u(a.data("showPrevious"),!0));var k=b('<div class="calendar-month-navigation"></div>');if(k.attr("id",a.attr("id")+"_nav-prev"),k.data("navigation","prev"),j!==!1){var l=f-1,m=d;l==-1&&(m-=1,l=11),k.data("to",{year:m,month:l+1}),k.append(h),"function"==typeof a.data("actionNavFunction")&&k.click(a.data("actionNavFunction")),k.click(function(b){e(a,c,m,l)})}var n=a.data("showNext");"number"!=typeof n&&n!==!1||(n=u(a.data("showNext"),!1));var o=b('<div class="calendar-month-navigation"></div>');if(o.attr("id",a.attr("id")+"_nav-next"),o.data("navigation","next"),n!==!1){var p=f+1,q=d;12==p&&(q+=1,p=0),o.data("to",{year:q,month:p+1}),o.append(i),"function"==typeof a.data("actionNavFunction")&&o.click(a.data("actionNavFunction")),o.click(function(b){e(a,c,q,p)})}var r=a.data("monthLabels"),s=b("<th></th>").append(k),t=b("<th></th>").append(o),v=b("<span>"+r[f]+" "+d+"</span>");v.dblclick(function(){var b=a.data("initDate");e(a,c,b.getFullYear(),b.getMonth())});var w=b('<th colspan="5"></th>');w.append(v);var x=b('<tr class="calendar-month-header"></tr>');return x.append(s,w,t),c.append(x),c}function h(a,c){if(a.data("showDays")===!0){var d=a.data("weekStartsOn"),e=a.data("dowLabels");if(0===d){var f=b.extend([],e),g=new Array(f.pop());e=g.concat(f)}var h=b('<tr class="calendar-dow-header"></tr>');b(e).each(function(a,b){h.append("<th>"+b+"</th>")}),c.append(h)}return c}function i(a,c,d,e){var g=(a.data("ajaxSettings"),s(d,e)),h=r(d,e),i=q(d,e,1),j=q(d,e,h),k=1,l=a.data("weekStartsOn");0===l&&(6==j&&g++,6!=i||0!=j&&1!=j&&5!=j||g--,i++,7==i&&(i=0));for(var m=0;m<g;m++){for(var n=b('<tr class="calendar-dow"></tr>'),t=0;t<7;t++){if(t<i||k>h)n.append("<td></td>");else{var u=a.attr("id")+"_"+p(d,e,k),v=u+"_day",w=b('<div id="'+v+'" class="day" >'+k+"</div>");w.data("day",k),a.data("showToday")===!0&&o(d,e,k)&&w.html('<span class="badge badge-today">'+k+"</span>");var x=b('<td id="'+u+'"></td>');x.append(w),x.data("date",p(d,e,k)),x.data("hasEvent",!1),"function"==typeof a.data("actionFunction")&&(x.addClass("dow-clickable"),x.click(function(){a.data("selectedDate",b(this).data("date"))}),x.click(a.data("actionFunction"))),n.append(x),k++}6==t&&(i=0)}c.append(n)}return c}function j(a,c,d,e){var f=b('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'),g=b('<h4 class="modal-title" id="'+a+'_modal_title">'+c+"</h4>"),h=b('<div class="modal-header"></div>');h.append(f),h.append(g);var i=b('<div class="modal-body" id="'+a+'_modal_body">'+d+"</div>"),j=b('<div class="modal-footer" id="'+a+'_modal_footer"></div>');if("undefined"!=typeof e){var k=b("<div>"+e+"</div>");j.append(k)}var l=b('<div class="modal-content"></div>');l.append(h),l.append(i),l.append(j);var m=b('<div class="modal-dialog"></div>');m.append(l);var n=b('<div class="modal fade" id="'+a+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+a+'_modal_title" aria-hidden="true"></div>');return n.append(m),n.data("dateId",a),n.attr("dateId",a),n}function k(a,b,c){var d=a.data("jsonData"),e=a.data("ajaxSettings");return a.data("events",!1),!1!==d?l(a):!1===e||m(a,b,c)}function l(a){var b=a.data("jsonData");return a.data("events",b),n(a,"json"),!0}function m(a,c,d){var e=a.data("ajaxSettings");if("object"!=typeof e||"undefined"==typeof e.url)return alert("Invalid calendar event settings"),!1;var f={year:c,month:d+1};return b.ajax({type:"GET",url:e.url,data:f,dataType:"json"}).done(function(c){var d=[];b.each(c,function(a,b){d.push(c[a])}),a.data("events",d),n(a,"ajax")}),!0}function n(a,c){var e=(a.data("jsonData"),a.data("ajaxSettings")),f=a.data("events");f!==!1&&b(f).each(function(d,f){var g=a.attr("id")+"_"+f.date,h=b("#"+g),i=b("#"+g+"_day");if(h.data("hasEvent",!0),"undefined"!=typeof f.title&&h.attr("title",f.title),"undefined"==typeof f.classname?h.addClass("event"):(h.addClass("event-styled"),i.addClass(f.classname)),"undefined"!=typeof f.badge&&f.badge!==!1){var k=f.badge===!0?"":" badge-"+f.badge,l=i.data("day");i.html('<span class="badge badge-event'+k+'">'+l+"</span>")}if("undefined"!=typeof f.body){var m=!1;if("json"===c&&"undefined"!=typeof f.modal&&f.modal===!0?m=!0:"ajax"===c&&"modal"in e&&e.modal===!0&&(m=!0),m===!0){h.addClass("event-clickable");var n=j(g,f.title,f.body,f.footer);b("body").append(n),b("#"+g).click(function(){b("#"+g+"_modal").modal()})}}})}function o(a,b,c){var d=new Date,e=new Date(a,b,c);return e.toDateString()==d.toDateString()}function p(a,b,c){var d,e;return e=c<10?"0"+c:c,d=b+1,d=d<10?"0"+d:d,a+"-"+d+"-"+e}function q(a,b,c){var d=new Date(a,b,c,0,0,0,0),e=d.getDay();return 0==e?e=6:e--,e}function r(a,b){for(var c=28;t(a,b+1,c+1);)c++;return c}function s(a,b){var c=r(a,b),d=q(a,b,1),e=q(a,b,c),f=c,g=d-e;return g>0&&(f+=g),Math.ceil(f/7)}function t(a,b,c){return b>0&&b<13&&a>0&&a<32768&&c>0&&c<=new Date(a,b,0).getDate()}function u(b,c){b===!1&&(b=0);var f,d=a.data("currDate"),e=a.data("initDate");if(f=12*(e.getFullYear()-d.getFullYear()),f-=d.getMonth()+1,f+=e.getMonth(),c===!0){if(f<parseInt(b)-1)return!0}else if(f>=0-parseInt(b))return!0;return!1}var a=b(this);a.attr("id","zabuto_calendar_"+Math.floor(99999*Math.random()).toString(36)),a.data("initYear",c.year),a.data("initMonth",c.month),a.data("monthLabels",c.month_labels),a.data("weekStartsOn",c.weekstartson),a.data("navIcons",c.nav_icon),a.data("dowLabels",c.dow_labels),a.data("showToday",c.today),a.data("showDays",c.show_days),a.data("showPrevious",c.show_previous),a.data("showNext",c.show_next),a.data("cellBorder",c.cell_border),a.data("jsonData",c.data),a.data("ajaxSettings",c.ajax),a.data("legendList",c.legend),a.data("actionFunction",c.action),a.data("actionNavFunction",c.action_nav),d()}),this},b.fn.zabuto_calendar_defaults=function(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,d={language:!1,year:b,month:c,show_previous:!0,show_next:!0,cell_border:!1,today:!1,show_days:!0,weekstartson:1,nav_icon:!1,data:!1,ajax:!1,legend:!1,action:!1,action_nav:!1};return d},b.fn.zabuto_calendar_language=function(a){switch("undefined"!=typeof a&&a!==!1||(a="en"),a.toLowerCase()){case"de":return{month_labels:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dow_labels:["Mo","Di","Mi","Do","Fr","Sa","So"]};case"en":return{month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],dow_labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};case"ar":return{month_labels:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],dow_labels:["أثنين","ثلاثاء","اربعاء","خميس","جمعه","سبت","أحد"]};case"es":return{month_labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dow_labels:["Lu","Ma","Mi","Ju","Vi","Sá","Do"]};case"fr":return{month_labels:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dow_labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]};case"it":return{month_labels:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dow_labels:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"]};case"nl":return{month_labels:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],dow_labels:["Ma","Di","Wo","Do","Vr","Za","Zo"]};case"pl":return{month_labels:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],dow_labels:["pon.","wt.","śr.","czw.","pt.","sob.","niedz."]};case"pt":return{month_labels:["Janeiro","Fevereiro","Marco","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dow_labels:["S","T","Q","Q","S","S","D"]};case"ru":return{month_labels:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dow_labels:["Пн","Вт","Ср","Чт","Пт","Сб","Вск"]};case"se":return{month_labels:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dow_labels:["Mån","Tis","Ons","Tor","Fre","Lör","Sön"]};case"tr":return{month_labels:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dow_labels:["Pts","Salı","Çar","Per","Cuma","Cts","Paz"]};case"fi":return{month_labels:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kesäkuu","Heinäkuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],dow_labels:["Ma","Ti","Ke","To","Pe","La","Su"]}}}}(window.jQuery);
